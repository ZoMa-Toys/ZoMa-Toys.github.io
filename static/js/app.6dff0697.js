(function(t){function e(e){for(var i,s,a=e[0],c=e[1],l=e[2],u=0,d=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},r={app:0},o=[];function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var h=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"42be":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("b0c0"),n("f9e3");var i=n("5f5b"),r=n("b1e0"),o=n("8203"),s=n.n(o),a=n("2b0e"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[t.authenticated?n("router-link",{attrs:{to:"/",replace:""},on:{click:function(e){return t.logout()}}},[t._v("Logout")]):t._e()],1),n("router-view",{on:{authenticated:t.setAuthenticated}}),n("div",[n("a",{staticStyle:{"background-color":"white"}},[t._v("Version: "+t._s(t.currentVersion))])])],1)},l=[],h=(n("ac1f"),n("5319"),{name:"App",data:function(){return{currentVersion:Object({VUE_APP_PORT:"80",VUE_APP_AUTO_LOGIN:"False",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_VERSION,authenticated:!1}},mounted:function(){this.authenticated||this.$router.replace({name:"login"}).catch((function(t){console.log(t)})),this.currentVersion||(this.currentVersion="devVersion")},methods:{setAuthenticated:function(t){this.authenticated=t},logout:function(){this.authenticated=!1}}}),u=h,d=(n("034f"),n("2877")),g=Object(d["a"])(u,c,l,!1,null,null,null),p=g.exports,f=n("8c4f"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-lg p-3 mb-5 rounded",staticStyle:{"background-color":"#f1f1f1"},attrs:{id:"switchControl"}},[n("div",{staticClass:"row shadow p-3 mb-5 rounded"},[n("number-input",{attrs:{min:2,max:99,controls:""},model:{value:t.rows,callback:function(e){t.rows=e},expression:"rows"}}),n("number-input",{attrs:{min:2,max:99,controls:""},model:{value:t.columns,callback:function(e){t.columns=e},expression:"columns"}}),n("b-button",{attrs:{variant:"primary"},on:{click:t.createTable}},[t._v("SetTable")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.rotatetable}},[t._v("RotateTable")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("SetThresHolds")}}},[t._v("ReconfigureSensors")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.pairCardsSwitches}},[t._v("pairCardsSwitches")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("setConfig")}}},[t._v("SaveThisConfig")]),n("b-form-select",{staticStyle:{width:"200px"},model:{value:t.currentConfName,callback:function(e){t.currentConfName=e},expression:"currentConfName"}},t._l(t.allConfNames,(function(e){return n("option",{key:e},[t._v(" "+t._s(e)+" ")])})),0),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("getConfByName")}}},[t._v("GetThisConfig")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("delConfByName")}}},[t._v("DelThisConfig")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.goto("Train")}}},[t._v("TrainControl")])],1),n("div",{staticClass:"shadow p-3 mb-5 rounded",on:{drop:t.dontDrop,dragover:t.dontDrop}},[n("table",[n("tr",[n("td",{style:"border: 1px solid black;width:100px; height=100px; background-color:"+t.color,attrs:{rowspan:"2"}},[n("img",{attrs:{draggable:"true",width:"104",height:"104",id:"leftSwitchStraight",src:"leftSwitchStraight.png"},on:{dragstart:t.drag,click:function(e){return t.rotateImage("leftSwitchStraight")}}})]),n("td",{style:"border: 1px solid black;width:100px; height=100px; background-color:"+t.color,attrs:{rowspan:"2"}},[n("img",{attrs:{draggable:"true",width:"104",height:"104",id:"rightSwitchStraight",src:"rightSwitchStraight.png"},on:{dragstart:t.drag,click:function(e){return t.rotateImage("rightSwitchStraight")}}})]),n("td",{attrs:{colspan:"4"}},[n("b-form-select",{model:{value:t.printed,callback:function(e){t.printed=e},expression:"printed"}},t._l(t.printed_list,(function(e,i,r){return n("option",{key:r},[t._v(" "+t._s(i)+" ")])})),0),n("b-form-input",{attrs:{type:"color"},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)]),n("tr",[n("td",{style:"border: 1px solid black; width:50px; height=50px; background-color:"+t.color},[n("img",{attrs:{draggable:"true",width:"50",height:"50",id:"curve",src:"curve.png"},on:{dragstart:t.drag,click:function(e){return t.rotateImage("curve")}}})]),n("td",{style:"border: 1px solid black; width:50px; height=50px; background-color:"+t.color},[n("img",{attrs:{draggable:"true",width:"50",height:"50",id:"Straight",src:"Straight.png"},on:{dragstart:t.drag,click:function(e){return t.rotateImage("Straight")}}})]),n("td",{style:"border: 1px solid black; width:50px; height=50px; background-color:"+t.color},[n("img",{attrs:{draggable:"true",width:"50",height:"50",id:"cross",src:"cross.png"},on:{dragstart:t.drag,click:function(e){return t.rotateImage("cross")}}})]),n("td",{style:"border: 1px solid black; width:50px; height=50px; background-color:"+t.color},[n("img",{attrs:{draggable:"true",width:"50",height:"50",id:"card",src:"card.png"},on:{dragstart:t.drag}})])])])]),t._m(0)])},b=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow p-3 mb-5 rounded"},[n("table",{staticStyle:{"margin-left":"auto","margin-right":"auto"},attrs:{id:"table"}})])}],w=n("3835"),v=n("b85c"),S=n("5530");n("7db0"),n("d3b7"),n("b64b"),n("e9c4"),n("caad"),n("2532"),n("1276"),n("a434"),n("159b"),n("4fad");function y(t,e){return Object.keys(t).find((function(n){return t[n]===e}))}function E(t,e,n){var i=new WebSocket(t);return i.onmessage=function(t){var n=t.data;e(JSON.parse(n))},i.onopen=function(){console.log("Successfully connected to the echo websocket server..."),n&&(n("getConfByName"),n("getConfsList"))},i}var _={name:"trackControl",data:function(){return{rows:14,columns:6,switchPairs:{},cardPairs:[],currentConfName:"Basic",allConfNames:[],conf:{},conf_str:"",motor_witch:[],card_witch:[],idmap:{},color:"#d6ffec",printed_list:{Original:!1,Printed:!0},printed:"Original",types:{left:{Original:{Straight:240,Turn:420},Printed:{Straight:280,Turn:380}},right:{Original:{Straight:420,Turn:240},Printed:{Straight:380,Turn:280}}},apihost:"ws://"+location.hostname+":80/ws"}},created:function(){this.connection=E(this.apihost,this.onMessage,this.sendAction)},mounted:function(){this.createTable()},watch:{conf_str:function(t){this.conf=JSON.parse(t),this.conf=Object(S["a"])({},this.conf)},conf:function(t){this.conf_str=JSON.stringify(t,null,2)}},methods:{connectWs:function(){this.connection.readyState!=this.connection.OPEN&&(this.connection=E(this.apihost,this.onMessage,null))},updateConf:function(){for(var t in this.conf){var e=this.conf[t],n=document.getElementById(t);this.idmap[t]=t;var i,r=Object(v["a"])(e.img);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=document.createElement("img");if(n.appendChild(s),s.style.backgroundColor=o.bgcolor,s.id=o.id,s.src=o.src,s.width=o.width,s.height=o.height,o.id.includes("card")){s.style.position=o.position,s.style.top=o.top,s.style.right=o.right,this.card_witch[o.index]=t;var a=document.createElement("p");a.innerHTML=o.index,a.style.right="20px",a.style.top="2px",a.style.position="absolute",n.appendChild(a)}else if(s.style.transform=o.transform,o.data.includes("Switch")){n.innerHTML+="<p>Switch "+e.switch.index+"</p>",this.motor_witch[e.switch.index]=t;var c=t.split(","),l=parseInt(c[0]),h=parseInt(c[1]);n.rowSpan=2,n.colSpan=2,document.getElementById(l+","+(h+1)).remove(),document.getElementById(l+1+","+h).remove(),document.getElementById(l+1+","+(h+1)).remove(),this.idmap[l+","+(h+1)]=t,this.idmap[l+1+","+h]=t,this.idmap[l+1+","+(h+1)]=t,n.addEventListener("click",this.switchImg)}}}catch(u){r.e(u)}finally{r.f()}}this.getSwitchPairs(),this.pairCardsSwitches()},onMessage:function(t){if("Status"in t)if("TrackConfig:"===t.Status)this.rows=t.Message.rows,this.columns=t.Message.columns,this.createTable(),this.conf=t.Message.conf,this.switchPairs=t.Message.switchPairs,this.cardPairs=t.Message.cardhPairs,this.updateConf();else if("swtiched"===t.Status){var e=this.motor_witch[t.Message.motor];if(void 0!==e){this.conf[e].switch.switched=y(this.conf[e].switch.pulse,t.Message.pulse);var n=document.getElementById(e).firstElementChild;n.src=this.changeDirection(n.src,this.conf[e].switch.switched),this.conf[e].img[0].src=this.changeDirection(this.conf[e].img[0].src,this.conf[e].switch.switched)}}else"ConfList:"===t.Status&&(this.allConfNames=t.Message)},getNow:function(){var t=new Date,e=t.getFullYear()+"_"+(t.getMonth()+1)+"_"+t.getDate(),n=t.getHours()+"_"+t.getMinutes()+"_"+t.getSeconds(),i=e+"_"+n;return i},sendAction:function(t){var e={action:t,config:{},name:this.getNow()};"setConfig"===t?e.config={conf:this.conf,rows:this.rows,columns:this.columns,switchPairs:this.switchPairs,cardPairs:this.cardPairs}:"getConfByName"!==t&&"delConfByName"!==t||(e.name=this.currentConfName),this.connectWs(),this.connection.send(JSON.stringify(e))},changeDirection:function(t,e){return e.includes("Turn")?t.replace("Straight","Turn"):t.replace("Turn","Straight")},jsonstring:function(){return JSON.stringify(this.conf,null,2)},dontDrop:function(t){t.preventDefault()},rotateImage:function(t){var e=document.getElementById(t),n=((parseInt(e.style.transform.replace("rotate(","").replace("deg)",""))||0)+90)%360;e.style.transform="rotate("+n+"deg)"},drag:function(t){t.dataTransfer.setData("text",t.target.id)},drop:function(t){t.preventDefault();var e=t.dataTransfer.getData("text");if(!e.includes("png")){var n=document.createElement("img"),i=document.getElementById(e);if(n.src=i.src,"card"==e&&"IMG"==t.target.tagName){n.id=e+" - address:"+t.target.parentElement.id,n.width=3*i.width/8,n.height=3*i.height/8,n.style.backgroundColor=this.color,n.style.position="absolute",n.style.top=0,n.style.right=0,this.card_witch.push(t.target.parentElement.id),t.target.parentElement.appendChild(n);var r=document.createElement("p");r.innerHTML=this.card_witch.length-1,r.style.right="20px",r.style.top="2px",r.style.position="absolute",t.target.parentElement.appendChild(r),this.conf[t.target.parentElement.id].img.push({index:this.card_witch.length-1,data:e,src:i.src,width:n.width,height:n.height,bgcolor:this.color,id:e+" - address:"+t.target.id,position:n.style.position,top:n.style.top,right:n.style.right})}else{var o=t.target.id.split(","),s=parseInt(o[0]),a=parseInt(o[1]);n.id=e+" - address:"+t.target.id,n.style.transform=i.style.transform,n.width=3*i.width/4,n.height=3*i.height/4,n.style.backgroundColor=this.color,t.target.childElementCount&&t.target.removeChild(t.target.childNodes[0]),this.idmap[t.target.id]=t.target.id,this.conf[t.target.id]={img:[{data:e,src:i.src,transform:i.style.transform,width:n.width,height:n.height,bgcolor:this.color,id:e+" - address:"+t.target.id}],neighbours:this.setNeighbours(t.target.id,i.id,i.style.transform)},e.includes("Switch")&&(t.target.rowSpan=2,t.target.colSpan=2,this.idmap[s+","+(a+1)]=t.target.id,this.idmap[s+1+","+a]=t.target.id,this.idmap[s+1+","+(a+1)]=t.target.id,this.insertOne(e,t.target.id),t.target.innerHTML+="<p>Switch "+this.conf[t.target.id].switch.index+"</p>",document.getElementById(s+","+(a+1)).remove(),document.getElementById(s+1+","+a).remove(),document.getElementById(s+1+","+(a+1)).remove(),n.addEventListener("click",this.switchImg)),t.target.appendChild(n),this.getSwitchPairs(),this.pairCardsSwitches()}}},allowDrop:function(t){t.preventDefault()},assignCardToSwitch:function(){},dragAway:function(t){if("none"!==t.dataTransfer.dropEffect){var e=t.target.parentElement;if(e.getElementsByTagName("p").length>0&&e.getElementsByTagName("p")[0].remove(),t.target.id.includes("Switch")){this.RemoveOne(t.target.id.split(":")[1]);var n=e.id.split(","),i=parseInt(n[0]),r=parseInt(n[1]);e.innerHTML="",e.rowSpan=1,e.colSpan=1,this.addCellWithExtra(e.parentElement,r+1,i+","+(r+1)),this.addCellWithExtra(e.parentElement.parentElement.rows[i+1],r,i+1+","+r),this.addCellWithExtra(e.parentElement.parentElement.rows[i+1],r+1,i+1+","+(r+1))}else if(t.target.id.includes("card")){var o=this.card_witch.indexOf(t.target.id.split(":")[1]);this.card_witch.splice(o,1)}t.target.remove(),delete this.conf[e.id];var s=Object(S["a"])({},this.conf);this.createTable(),this.conf=Object(S["a"])({},s),this.updateConf()}},addCellWithExtra:function(t,e,n){var i=t.insertCell(e);i.id=n,i.classList.add("tdclass"),i.style+="width: 37px; height: 37px;border: 1px solid black;",i.addEventListener("drop",this.drop),i.addEventListener("dragover",this.allowDrop),i.addEventListener("dragend",this.dragAway)},createTable:function(){this.idmap={},this.conf={},this.motor_witch=[],this.card_witch=[],this.cardPairs=[];var t=document.getElementById("table");t.innerHTML="";for(var e=0;e<this.rows;e++)for(var n=t.insertRow(),i=0;i<this.columns;i++){var r=n.insertCell(),o=e+","+i;r.id=o,r.classList.add("tdclass"),r.style="width: 37px; height: 37px;border: 1px solid black;",r.addEventListener("drop",this.drop),r.addEventListener("dragover",this.allowDrop),r.addEventListener("dragend",this.dragAway)}},switchImg:function(t){var e=t.target;this.sendToBE(e.id.split(":")[1])},sendToBE:function(t){var e=Object(S["a"])({},this.conf[t].switch);"Straight"==e.switched?e.switched="Turn":e.switched="Straight";var n=e.pulse[e.switched],i=this.printed_list[e.printed],r=JSON.stringify({action:"swtichMotor",message:{motor:e.index,pulse:n,printed:i}});this.connectWs(),this.connection.send(r)},insertOne:function(t,e){this.motor_witch.push(e),this.conf[e]["switch"]={index:this.motor_witch.length-1,type:t.includes("left")?"left":"right",pulse:this.types[t.includes("left")?"left":"right"][this.printed],switched:t.includes("Turn")?"Turn":"Straight",printed:this.printed}},RemoveOne:function(t){var e=this,n=this.motor_witch.indexOf(t);this.motor_witch.splice(n,1),this.motor_witch.forEach((function(t,n){e.conf[t].switch.index=n}))},goto:function(t){this.$router.replace({name:t})},rotatetable:function(){var t={};for(var e in this.idmap={},this.conf){var n=e.split(","),i=this.rows-parseInt(n[0])-1,r=parseInt(n[1]),o=((parseInt(this.conf[e].img[0].transform.replace("rotate(","").replace("deg)",""))||0)+90)%360,s=void 0;this.conf[e].img[0].data.includes("Switch")?(s=r+","+(i-1),this.idmap[s]=s,this.idmap[r+","+i]=s,this.idmap[r+1+","+(i-1)]=s,this.idmap[r+1+","+i]=s):s=r+","+i,this.idmap[s]=s,t[s]=this.conf[e],t[s].img[0].transform="rotate("+o+"deg)",t[s].img[0].id=t[s].img[0].id.replace(e,s),t[s].neighbours=this.setNeighbours(s,t[s].img[0].id.split(" ")[0],t[s].img[0].transform)}var a=this.rows;this.rows=this.columns,this.columns=a,this.createTable(),this.conf=t,this.updateConf()},setNeighbours:function(t,e,n){var i=t.split(","),r={leftSwitchStraight:[null,null,"t","s",null,null,"i",null],rightSwitchStraight:[null,null,null,"i",null,null,"s","t"],Straight:[null,"i",null,"o"],curve:[null,"i","o",null],cross:["r","i","l",null]},o=[[-1,0],[-1,1],[0,2],[1,2],[2,1],[2,0],[1,-1],[0,-1]],s=[[-1,0],[0,1],[1,0],[0,-1]],a=[],c={};a=e.includes("Switch")?o:s;for(var l=0;l<parseInt(n.replace("rotate(","").replace("deg)",""))/90*r[e].length/4;l++)r[e].unshift(r[e].pop());for(var h=0;h<r[e].length;h++)null!=r[e][h]&&(c[r[e][h]]=a[h][0]+parseInt(i[0])+","+(a[h][1]+parseInt(i[1])));return c},getnextSwitch:function(t,e,n,i){if(Object.entries(this.conf,t)&&void 0!=t)for(var r=0,o=Object.entries(this.conf[t].neighbours);r<o.length;r++){var s=o[r],a=this.idmap[s[1]];a!=e&&a!=t&&Object.prototype.hasOwnProperty.call(this.conf,a)&&(this.motor_witch.includes(a)?this.switchPairs[n][i].push([y(this.conf[a].neighbours,t),a]):this.getnextSwitch(a,t,n,i))}else this.switchPairs[n][i]=[]},getSwitchPairs:function(){var t=this;this.switchPairs={},this.motor_witch.forEach((function(e){t.switchPairs[e]={},["i","s","t"].forEach((function(n){t.switchPairs[e][n]=[],t.getnextSwitch(t.idmap[t.conf[e].neighbours[n]],e,e,n)}))}))},pairCardsSwitches:function(){var t=this;this.cardPairs=[];for(var e=function(){var e=Object(w["a"])(i[n],2),r=e[0],o=e[1];if(""!=o){t.conf[r]["card_index"]={};for(var s=function(){var e=Object(w["a"])(c[a],2),n=e[0],i=e[1],o=t.conf[r].neighbours[n],s=t.card_witch.indexOf(o);t.conf[r]["card_index"][n]=s,t.cardPairs[s]=[],i.forEach((function(e){if(e[1]in t.conf){var i=t.conf[e[1]].neighbours[e[0]],o=t.card_witch.indexOf(i);t.cardPairs[s].push([[n,r],o,e])}}))},a=0,c=Object.entries(o);a<c.length;a++)s()}},n=0,i=Object.entries(this.switchPairs);n<i.length;n++)e()},consoleLog:function(){this.conf=Object(S["a"])({},this.conf);var t={conf:this.conf,rows:this.rows,columns:this.columns,switchPairs:this.switchPairs,cardPairs:this.cardPairs};console.log(JSON.stringify(t,null,2))}}},N=_,x=(n("e927"),Object(d["a"])(N,m,b,!1,null,null,null)),O=x.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-lg p-3 mb-5 rounded",staticStyle:{"background-color":"#f1f1f1"},attrs:{id:"train"}},[n("table",[n("tr",[n("td",{staticStyle:{"vertical-align":"top"}},[n("tr",[n("td",{attrs:{colspan:"4"}},[n("div",{staticClass:"row"},[t._v(" Number of Hubs: "),n("number-input",{attrs:{min:0,max:8-t.NumberOfRemotes,controls:""},model:{value:t.NumberOfHubs,callback:function(e){t.NumberOfHubs=e},expression:"NumberOfHubs"}}),t._v(" Number of Remotes: "),n("number-input",{attrs:{min:0,max:8-t.NumberOfHubs,controls:""},model:{value:t.NumberOfRemotes,callback:function(e){t.NumberOfRemotes=e},expression:"NumberOfRemotes"}}),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.sendAction("scan")}}},[t._v("startScan")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("stop")}}},[t._v("stopScan")]),n("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.sendAction("getHubs")}}},[t._v("getHubs")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("disconnectHubs")}}},[t._v("disconnectAllHub")]),n("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.sendAction("resetCardMap")}}},[t._v("resetCardMap")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.goto("swtichControl")}}},[t._v("SwitchControl")])],1)])]),t._l(t.trains,(function(e){return n("controller",{key:e.NAME,attrs:{train:e,hubs:t.hubs,Colors:t.Colors,setPower:t.setPower,changeSpeed:t.changeSpeed,changeLight:t.changeLight}})}))],2)])])])},M=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("td",{staticStyle:{"max-width":"800"}},[n("div",{style:"text-align: center;border-style: solid; border-color:gray;position: relative;fontcolor:black; background: rgba("+t.Colors[t.hubs[t.train.NAME].traincolor][1]+","+t.Colors[t.hubs[t.train.NAME].traincolor][2]+","+t.Colors[t.hubs[t.train.NAME].traincolor][3]+",0.3)"},[n("h1",[t._v(" "+t._s(t.train.NAME))]),t.train?n("b-row",{attrs:{"no-gutters":""}},[n("b-row",{staticStyle:{margin:"auto"},attrs:{"no-gutters":""}},[n("div",{staticStyle:{"text-align":"center",margin:"auto"}},[n("label",[t._v(" Speed: ")]),n("h1",{staticStyle:{"font-size":"6em"}},[t._v(" "+t._s(t.hubs[t.train.NAME].speed))])]),n("div",{staticStyle:{"margin-left":"auto"}},[n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"plus-circle"},on:{click:function(e){return t.changeSpeed(t.train.NAME,10)}}}),n("br"),n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"stop-circle",variant:"danger"},on:{click:function(e){return t.changeSpeed(t.train.NAME,0)}}}),n("br"),n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"dash-circle"},on:{click:function(e){return t.changeSpeed(t.train.NAME,-10)}}})],1)]),"COLOR_DISTANCE_SENSOR"in t.train?n("div",{staticStyle:{"margin-right":"0","margin-left":"auto"}},[n("div",{staticStyle:{"border-style":"solid","border-color":"gray"}},[n("label",[t._v("Slow down if distance is less then: "+t._s(t.hubs[t.train.NAME].newdistanceSlow)+" ")]),n("b-form-input",{attrs:{type:"range",min:t.hubs[t.train.NAME].newdistance,max:"260",step:"10"},on:{change:function(e){return t.setPower(t.train.NAME,"distanceSlow")}},model:{value:t.hubs[t.train.NAME].newdistanceSlow,callback:function(e){t.$set(t.hubs[t.train.NAME],"newdistanceSlow",e)},expression:"hubs[train.NAME].newdistanceSlow"}}),n("h5",[t._v("CurrentValue: "+t._s(t.hubs[t.train.NAME].distanceSlow))]),n("label",[t._v("Slow down if color is:")]),n("b-form-select",{style:255===t.hubs[t.train.NAME].colorSlow?"":"fontcolor:black; background: rgba("+t.Colors[t.hubs[t.train.NAME].colorSlow][1]+","+t.Colors[t.hubs[t.train.NAME].colorSlow][2]+","+t.Colors[t.hubs[t.train.NAME].colorSlow][3]+",0.6)",on:{change:function(e){return t.setPower(t.train.NAME,"colorSlow")}},model:{value:t.hubs[t.train.NAME].newcolorSlow,callback:function(e){t.$set(t.hubs[t.train.NAME],"newcolorSlow",e)},expression:"hubs[train.NAME].newcolorSlow"}},t._l(t.Colors,(function(e,i){return n("option",{key:i,domProps:{value:parseInt(i)}},[t._v(" "+t._s(e[0])+" ")])})),0)],1),n("div",{staticStyle:{"border-style":"solid","border-color":"gray"}},[n("label",[t._v("Stop if distance is less then: "+t._s(t.hubs[t.train.NAME].newdistance))]),n("b-form-input",{attrs:{type:"range",min:"0",max:"260",step:"10"},on:{change:function(e){return t.setPower(t.train.NAME,"distance")}},model:{value:t.hubs[t.train.NAME].newdistance,callback:function(e){t.$set(t.hubs[t.train.NAME],"newdistance",e)},expression:"hubs[train.NAME].newdistance"}}),n("h5",[t._v("CurrentValue: "+t._s(t.hubs[t.train.NAME].distance))]),n("label",[t._v("Stop if color is:")]),n("b-form-select",{style:255===t.hubs[t.train.NAME].color?"":"fontcolor:black; background: rgba("+t.Colors[t.hubs[t.train.NAME].color][1]+","+t.Colors[t.hubs[t.train.NAME].color][2]+","+t.Colors[t.hubs[t.train.NAME].color][3]+",0.5)",on:{change:function(e){return t.setPower(t.train.NAME,"color")}},model:{value:t.hubs[t.train.NAME].newcolor,callback:function(e){t.$set(t.hubs[t.train.NAME],"newcolor",e)},expression:"hubs[train.NAME].newcolor"}},t._l(t.Colors,(function(e,i){return n("option",{key:i,domProps:{value:parseInt(i)}},[t._v(" "+t._s(e[0])+" ")])})),0)],1)]):t._e(),"LIGHT"in t.train?n("b-row",{staticStyle:{"margin-right":"0","margin-left":"auto"},attrs:{"no-gutters":""}},[n("div",{staticStyle:{"text-align":"center",margin:"auto"}},[n("label",[t._v(" Light: ")]),n("h1",{staticStyle:{"font-size":"6em"}},[t._v(" "+t._s(t.hubs[t.train.NAME].light))])]),n("div",{staticStyle:{"margin-left":"auto"}},[n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"plus-circle"},on:{click:function(e){return t.changeLight(t.train.NAME,10)}}}),n("br"),n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"stop-circle",variant:"danger"},on:{click:function(e){return t.changeLight(t.train.NAME,0)}}}),n("br"),n("b-icon",{staticStyle:{width:"120px",height:"120px"},attrs:{icon:"dash-circle"},on:{click:function(e){return t.changeLight(t.train.NAME,-10)}}})],1)]):t._e()],1):t._e()],1)])])},k=[],P=n("0759"),T={components:{BIcon:P["a"]},props:["train","hubs","Colors","setPower","changeSpeed","changeLight"]},I=T,L=Object(d["a"])(I,A,k,!1,null,null,null),R=L.exports;function j(t,e){var n=new WebSocket(t);return n.onmessage=function(t){var n=t.data;e(JSON.parse(n))},n.onopen=function(){console.log("Successfully connected to the echo websocket server...")},n}function B(){return{connection:null,apihost:"ws://"+location.hostname+":80/ws",trains:[{NAME:"DUMMY",TRAIN_MOTOR:0,COLOR_DISTANCE_SENSOR:1,LIGHT:2,traincolor:1}],hubs:{DUMMY:{speed:0,train:"DUMMY",traincolor:1,MotorPort:0,distanceSlow:0,colorSlow:255,distance:0,color:255,light:0,newdistanceSlow:0,newcolorSlow:255,newdistance:0,newcolor:255,newlight:0}},NumberOfHubs:1,NumberOfRemotes:1,ColorsOld:{BLACK:0,PINK:1,PURPLE:2,BLUE:3,LIGHTBLUE:4,CYAN:5,GREEN:6,YELLOW:7,ORANGE:8,RED:9,WHITE:10,NONE:255},Colors:{0:["BLACK",0,0,0],1:["PINK",255,192,203],2:["PURPLE",128,0,128],3:["BLUE",0,0,255],4:["LIGHTBLUE",173,216,230],5:["CYAN",0,255,255],6:["GREEN",0,128,0],7:["YELLOW",255,255,0],8:["ORANGE",255,155,0],9:["RED",255,0,0],10:["WHITE",255,255,255],255:["NONE",255,255,255]}}}var H={name:"Train",data:function(){return B()},components:{controller:R},watch:{},created:function(){this.connection=j(this.apihost,this.updateTrain,null)},methods:{connectWs:function(){this.connection.readyState!=this.connection.OPEN&&(this.connection=j(this.apihost,this.updateTrain,null))},updateTrain:function(t){if("Connected Hubs:"===t.Status)this.trains=t.Message,this.fillHubs();else if("Setting Speed..."===t.Status){var e=t.Message;"speed"in e&&(this.hubs[e.train].speed=e.speed),"speed"in e&&(this.hubs[e.train].newspeed=e.speed),"distanceSlow"in e&&(this.hubs[e.train].distanceSlow=e.distanceSlow),"distanceSlow"in e&&(this.hubs[e.train].newdistanceSlow=e.distanceSlow),"colorSlow"in e&&(this.hubs[e.train].colorSlow=e.colorSlow),"colorSlow"in e&&(this.hubs[e.train].newcolorSlow=e.colorSlow),"distance"in e&&(this.hubs[e.train].distance=e.distance),"distance"in e&&(this.hubs[e.train].newdistance=e.distance),"color"in e&&(this.hubs[e.train].color=e.color),"color"in e&&(this.hubs[e.train].newcolor=e.color),"light"in e&&(this.hubs[e.train].light=e.light),"light"in e&&(this.hubs[e.train].newlight=e.light),this.hubs=Object(S["a"])({},this.hubs)}},sendAction:function(t){var e={action:t};t.includes("scan")&&(e["NumberOfHubs"]=this.NumberOfHubs,e["NumberOfRemotes"]=this.NumberOfRemotes),this.connectWs(),this.connection.send(JSON.stringify(e))},setPower:function(t,e){var n={action:"setPower",message:{}};n.message["train"]=this.hubs[t].train,n.message[e]=this.hubs[t]["new"+e],this.connectWs(),this.connection.send(JSON.stringify(n))},fillHubs:function(){var t=this;this.hubs={},this.trains.forEach((function(e){"TRAIN_MOTOR"in e&&(t.hubs[e.NAME]={speed:0,train:e.NAME,traincolor:e.traincolor,MotorPort:e.TRAIN_MOTOR,distanceSlow:0,colorSlow:255,distance:0,color:255,newdistanceSlow:0,newcolorSlow:255,newdistance:0,newcolor:255,light:0,newlight:0})}))},goto:function(t){this.$router.replace({name:t})},changeSpeed:function(t,e){this.hubs[t].newspeed=0===e?0:Math.max(Math.min(this.hubs[t].speed+e,100),-100),this.setPower(t,"speed")},changeLight:function(t,e){this.hubs[t].newlight=0===e?0:Math.max(Math.min(this.hubs[t].light+e,100),-100),this.setPower(t,"light")}}},D=H,U=Object(d["a"])(D,C,M,!1,null,null,null),$=U.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shadow-lg p-3 mb-5 rounded",attrs:{id:"login"}},[n("h1",[t._v("Login")]),n("b-form",{staticClass:"w-100",on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[n("b-form-input",{attrs:{type:"text",name:"username",placeholder:"Username"},model:{value:t.input.username,callback:function(e){t.$set(t.input,"username",e)},expression:"input.username"}}),n("b-form-input",{attrs:{type:"password",name:"password",placeholder:"Password"},model:{value:t.input.password,callback:function(e){t.$set(t.input,"password",e)},expression:"input.password"}}),n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Login")])],1),n("div",{staticStyle:{color:"red"}},[t._v(t._s(t.message))])],1)},W=[],G={name:"Login",data:function(){return{input:{username:"",password:""},message:"",apihost:Object({VUE_APP_PORT:"80",VUE_APP_AUTO_LOGIN:"False",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_APIHOST}},methods:{login:function(){""!=this.input.username&&""!=this.input.password?"Familymember"===this.input.username&"WE4RTsdf!"===this.input.password?(this.$emit("authenticated",!0),this.$router.replace({name:"swtichControl"})):(this.message="The username and / or password is incorrect",console.log("The username and / or password is incorrect")):(this.message="A username and password must be present",console.log("A username and password must be present"))}}},J=G,Y=(n("6fed"),Object(d["a"])(J,V,W,!1,null,"afcf3372",null)),F=Y.exports;a["default"].use(f["a"]);var K=new f["a"]({mode:"history",routes:[{path:"/",name:"login",component:F},{path:"/swtichControl",name:"swtichControl",component:O},{path:"/train",name:"Train",component:$}]});n("2dd8");a["default"].use(i["a"]),a["default"].use(r["a"]),a["default"].component(s.a.name,s.a),new a["default"]({router:K,render:function(t){return t(p)}}).$mount("#app")},"6fed":function(t,e,n){"use strict";n("b8a3")},"85ec":function(t,e,n){},b8a3:function(t,e,n){},e927:function(t,e,n){"use strict";n("42be")}});
//# sourceMappingURL=app.6dff0697.js.map